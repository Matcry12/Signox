{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Video Library" %} - Signox{% endblock %}

{% block extra_css %}
<style>
    .video-card {
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .video-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
    }

    .video-thumbnail {
        position: relative;
        height: 180px;
        background: var(--bg-tertiary);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .video-thumbnail img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .play-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 60px;
        height: 60px;
        background: rgba(0,0,0,0.7);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        opacity: 0;
        transition: opacity 0.2s;
    }

    .video-card:hover .play-overlay {
        opacity: 1;
    }

    .view-count {
        position: absolute;
        bottom: 0.5rem;
        right: 0.5rem;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: var(--radius-sm);
        font-size: 0.75rem;
    }

    .filter-sidebar {
        position: sticky;
        top: 80px;
    }

    /* Dark Mode Styles */
    [data-theme="dark"] h1 {
        color: #F1F5F9;
    }

    [data-theme="dark"] .video-thumbnail {
        background: #334155;
    }

    [data-theme="dark"] .card-body h3 {
        color: #F1F5F9;
    }

    [data-theme="dark"] .card-header h3 {
        color: #F1F5F9;
    }

    [data-theme="dark"] .form-label {
        color: #CBD5E1;
    }

    [data-theme="dark"] .text-center h2 {
        color: #F1F5F9;
    }

    /* Mobile Responsive Styles */
    .video-page-grid {
        display: grid;
        grid-template-columns: 250px 1fr;
        gap: 2rem;
    }

    @media (max-width: 768px) {
        .video-page-grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        .filter-sidebar {
            position: static;
        }
        h1 {
            font-size: 1.5rem !important;
        }
    }

    @media (max-width: 480px) {
        h1 {
            font-size: 1.375rem !important;
        }
        .video-thumbnail {
            height: 150px;
        }
        .play-overlay {
            width: 50px;
            height: 50px;
        }
        .card-body h3 {
            font-size: 0.9375rem !important;
        }
        .pagination {
            flex-wrap: wrap;
            gap: 0.5rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">{% trans "Video Library" %}</h1>
    <p style="color: var(--text-secondary); margin-bottom: 2rem;">{% trans "Learn from real-life situation videos" %}</p>

    <div class="video-page-grid">
        <!-- Sidebar Filters -->
        <div>
            <div class="card filter-sidebar">
                <div class="card-header">
                    <h3 style="font-size: 1rem;">{% trans "Filters" %}</h3>
                </div>
                <div class="card-body">
                    <form method="get">
                        <div class="form-group">
                            <label class="form-label">{% trans "Search" %}</label>
                            <input type="text" name="search" class="form-control" placeholder="{% trans 'Search videos...' %}" value="{{ request.GET.search }}">
                        </div>

                        <div class="form-group">
                            <label class="form-label">{% trans "Category" %}</label>
                            <select name="category" class="form-control">
                                <option value="">{% trans "All Categories" %}</option>
                                {% for cat in categories %}
                                <option value="{{ cat.slug }}" {% if request.GET.category == cat.slug %}selected{% endif %}>
                                    {{ cat.name }} ({{ cat.video_count }})
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">{% trans "Difficulty" %}</label>
                            <select name="difficulty" class="form-control">
                                <option value="">{% trans "All Levels" %}</option>
                                <option value="easy" {% if request.GET.difficulty == 'easy' %}selected{% endif %}>{% trans "Easy" %}</option>
                                <option value="medium" {% if request.GET.difficulty == 'medium' %}selected{% endif %}>{% trans "Medium" %}</option>
                                <option value="hard" {% if request.GET.difficulty == 'hard' %}selected{% endif %}>{% trans "Hard" %}</option>
                            </select>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%;">{% trans "Apply Filters" %}</button>
                        <a href="{% url 'video_list' %}" class="btn btn-secondary mt-1" style="width: 100%;">{% trans "Clear" %}</a>
                    </form>
                </div>
            </div>
        </div>

        <!-- Video Grid -->
        <div>
            <div class="grid grid-3">
                {% for video in videos %}
                <a href="{% url 'video_detail' video.slug %}" class="card video-card">
                    <div class="video-thumbnail">
                        {% if video.thumbnail %}
                            <img src="{{ video.thumbnail.url }}" alt="{{ video.title }}">
                        {% else %}
                            <svg width="48" height="48" fill="none" stroke="var(--text-secondary)" stroke-width="1.5" viewBox="0 0 24 24">
                                <path d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        {% endif %}
                        <div class="play-overlay">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                        </div>
                        <span class="view-count">{{ video.view_count }} {% trans "views" %}</span>
                    </div>
                    <div class="card-body">
                        <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">{{ video.title }}</h3>
                        <div class="flex gap-1">
                            <span class="badge badge-{% if video.difficulty == 'easy' %}success{% elif video.difficulty == 'medium' %}warning{% else %}danger{% endif %}">
                                {{ video.get_difficulty_display }}
                            </span>
                            <span style="font-size: 0.75rem; color: var(--text-secondary);">{{ video.category.name }}</span>
                        </div>
                    </div>
                </a>
                {% empty %}
                <div style="grid-column: 1/-1;" class="card">
                    <div class="card-body text-center" style="padding: 3rem;">
                        <svg width="64" height="64" fill="none" stroke="var(--text-secondary)" stroke-width="1.5" viewBox="0 0 24 24" style="margin: 0 auto 1rem;">
                            <path d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        <h2>{% trans "No Videos Found" %}</h2>
                        <p style="color: var(--text-secondary);">{% trans "Try adjusting your filters" %}</p>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Pagination -->
            {% if videos.has_other_pages %}
            <div style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 2rem;">
                {% if videos.has_previous %}
                <a href="?page={{ videos.previous_page_number }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.difficulty %}&difficulty={{ request.GET.difficulty }}{% endif %}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="btn btn-secondary">{% trans "Previous" %}</a>
                {% endif %}

                <span class="btn btn-outline" style="cursor: default;">{% trans "Page" %} {{ videos.number }} {% trans "of" %} {{ videos.paginator.num_pages }}</span>

                {% if videos.has_next %}
                <a href="?page={{ videos.next_page_number }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.difficulty %}&difficulty={{ request.GET.difficulty }}{% endif %}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="btn btn-secondary">{% trans "Next" %}</a>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
